

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>wolfssl Python 3.13.0-0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="None" href="index.html#document-index"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html#document-index" class="icon icon-home"> wolfssl Python
          

          
          </a>

          
            
            
              <div class="version">
                3.13.0-0
              </div>
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-installation">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-usage">Basic Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#using-the-top-level-function-wolfssl-wrap-socket">Using the top level function wolfssl.wrap_socket()</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#using-the-method-wrap-socket-from-a-sslcontext-instance">Using the method wrap_socket() from a SSLContext instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#creating-an-sslsocket-object-from-the-scratch">Creating an SSLSocket object from the scratch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#wrap-socket">wrap_socket</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#ssl-tls-context">SSL/TLS Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#ssl-tls-socket">SSL/TLS Socket</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-examples">Client and Server Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#ssl-tls-client-example">SSL/TLS Client Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#ssl-tls-server-example">SSL/TLS Server Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-licensing">Licensing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#open-source">Open Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#commercial-licensing">Commercial Licensing</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html#document-index">wolfssl Python</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html#document-index">Docs</a> &raquo;</li>
        
      <li>wolfssl Python 3.13.0-0 documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="toctree-wrapper compound">
<span id="document-installation"></span><div class="section" id="welcome">
<h1>Welcome<a class="headerlink" href="#welcome" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://travis-ci.org/wolfSSL/wolfssl-py"><img alt="https://travis-ci.org/wolfSSL/wolfssl-py.svg?branch=master" src="https://travis-ci.org/wolfSSL/wolfssl-py.svg?branch=master" /></a>
<p><strong>wolfSSL Python</strong>, a.k.a. <code class="docutils literal"><span class="pre">wolfssl</span></code> is a Python module
that encapsulates <a class="reference external" href="https://wolfssl.com/wolfSSL/Products-wolfssl.html">wolfSSL’s SSL/TLS library</a>.</p>
<p><strong>wolfSSL’s SSL/TLS library</strong> is a lightweight, portable, C-language-based
library targeted at IoT, embedded, and RTOS environments primarily because of
its size, speed, and feature set. It works seamlessly in desktop, enterprise,
and cloud environments as well.</p>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>We provide Python wheels (prebuilt binaries) for OSX 64 bits and Linux 64 bits:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ pip install wolfssl
</pre></div>
</div>
</div>
<span id="document-usage"></span><div class="section" id="basic-usage">
<h1>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h1>
<p>The SSL/TLS protocol works securing an underlying TCP connection, this module
adds the secure layer around the Python standard library
<a class="reference external" href="https://docs.python.org/3.6/library/socket.html">socket</a> module.</p>
<p>There are three different paths to secure a socket in this module:</p>
<ul class="simple">
<li>Using the top level function wolfssl.wrap_socket();</li>
<li>Using the method wrap_socket() from a SSLContext instance;</li>
<li>Creating an SSLSocket object from the scratch.</li>
</ul>
<dl class="docutils">
<dt>Note 1:</dt>
<dd>It is possible to use the same SSLContext for multiple SSLSockets to save
time and resources.</dd>
<dt>Note 2:</dt>
<dd>Each path provides its own options for fine-tuning the securint parameters.
Check them out in the API documentation.</dd>
</dl>
<div class="section" id="using-the-top-level-function-wolfssl-wrap-socket">
<h2>Using the top level function wolfssl.wrap_socket()<a class="headerlink" href="#using-the-top-level-function-wolfssl-wrap-socket" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">socket</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wolfssl</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span> <span class="o">=</span> <span class="n">wolfssl</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&quot;www.python.org&quot;</span><span class="p">,</span> <span class="mi">443</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;GET / HTTP/1.1</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">secure_socket</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">b&#39;HTTP/1.1 500 Domain Not Found\r\nServer: Varnish\r\nRetry-After: 0\r\ncontent-type: text/html\r\nCache-Control: private, no-cache\r\nconnection: keep-alive\r\nContent-Length: 179\r\nAccept-Ranges: bytes\r\nDate: Sun, 05 Feb 2017 21:26:48 GMT\r\nVia: 1.1 varnish\r\nConnection: keep-alive\r\n\r\n\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Fastly error: unknown domain &lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\nFastly error: unknown domain: . Please check that this domain has been added to a service.&lt;/body&gt;&lt;/html&gt;&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="using-the-method-wrap-socket-from-a-sslcontext-instance">
<h2>Using the method wrap_socket() from a SSLContext instance<a class="headerlink" href="#using-the-method-wrap-socket-from-a-sslcontext-instance" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">socket</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wolfssl</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span> <span class="o">=</span> <span class="n">wolfssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">wolfssl</span><span class="o">.</span><span class="n">PROTOCOL_TLSv1_2</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&quot;www.python.org&quot;</span><span class="p">,</span> <span class="mi">443</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;GET / HTTP/1.1</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">secure_socket</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">b&#39;HTTP/1.1 500 Domain Not Found\r\nServer: Varnish\r\nRetry-After: 0\r\ncontent-type: text/html\r\nCache-Control: private, no-cache\r\nconnection: keep-alive\r\nContent-Length: 179\r\nAccept-Ranges: bytes\r\nDate: Sun, 05 Feb 2017 21:26:48 GMT\r\nVia: 1.1 varnish\r\nConnection: keep-alive\r\n\r\n\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Fastly error: unknown domain &lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\nFastly error: unknown domain: . Please check that this domain has been added to a service.&lt;/body&gt;&lt;/html&gt;&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-an-sslsocket-object-from-the-scratch">
<h2>Creating an SSLSocket object from the scratch<a class="headerlink" href="#creating-an-sslsocket-object-from-the-scratch" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">socket</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wolfssl</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span> <span class="o">=</span> <span class="n">wolfssl</span><span class="o">.</span><span class="n">SSLSocket</span><span class="p">(</span><span class="n">sock</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&quot;www.python.org&quot;</span><span class="p">,</span> <span class="mi">443</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;GET / HTTP/1.1</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">secure_socket</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">b&#39;HTTP/1.1 500 Domain Not Found\r\nServer: Varnish\r\nRetry-After: 0\r\ncontent-type: text/html\r\nCache-Control: private, no-cache\r\nconnection: keep-alive\r\nContent-Length: 179\r\nAccept-Ranges: bytes\r\nDate: Sun, 05 Feb 2017 21:26:48 GMT\r\nVia: 1.1 varnish\r\nConnection: keep-alive\r\n\r\n\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Fastly error: unknown domain &lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\nFastly error: unknown domain: . Please check that this domain has been added to a service.&lt;/body&gt;&lt;/html&gt;&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secure_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<span id="document-api"></span><div class="section" id="module-wolfssl">
<span id="api-documentation"></span><h1>API Documentation<a class="headerlink" href="#module-wolfssl" title="Permalink to this headline">¶</a></h1>
<div class="section" id="wrap-socket">
<h2>wrap_socket<a class="headerlink" href="#wrap-socket" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="wolfssl.wrap_socket">
<code class="descclassname">wolfssl.</code><code class="descname">wrap_socket</code><span class="sig-paren">(</span><em>sock</em>, <em>keyfile=None</em>, <em>certfile=None</em>, <em>server_side=False</em>, <em>cert_reqs=0</em>, <em>ssl_version=1</em>, <em>ca_certs=None</em>, <em>do_handshake_on_connect=True</em>, <em>suppress_ragged_eofs=True</em>, <em>ciphers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.wrap_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an instance sock of socket.socket, and returns an instance of
wolfssl.SSLSocket, wraping the underlying socket in an SSL context.</p>
<p>The sock parameter must be a SOCK_STREAM socket; other socket types are
unsupported.</p>
<p>The keyfile and certfile parameters specify optional files whith proper
key and the certificates used to identify the local side of the connection.</p>
<p>The parameter server_side is a boolean which identifies whether server-side
or client-side behavior is desired from this socket.</p>
<p>The parameter cert_reqs specifies whether a certificate is required from
the other side of the connection, and whether it will be validated if
provided.
It must be one of the three values:</p>
<blockquote>
<div><ul class="simple">
<li>CERT_NONE (certificates ignored)</li>
<li>CERT_OPTIONAL (not required, but validated if provided)</li>
<li>CERT_REQUIRED (required and validated)</li>
</ul>
</div></blockquote>
<p>If the value of this parameter is not CERT_NONE, then the ca_certs
parameter must point to a file of CA certificates.</p>
<p>The ca_certs file contains a set of concatenated “certification authority”
certificates, which are used to validate certificates passed from the other
end of the connection.</p>
<p>The parameter ssl_version specifies which version of the SSL protocol to
use. Typically, the server chooses a particular protocol version, and the
client must adapt to the server’s choice. Most of the versions are not
interoperable with the other versions. If not specified, the default is
PROTOCOL_TLS; it provides the most compatibility with other versions.</p>
<p>Here’s a table showing which versions in a client (down the side) can
connect to which versions in a server (along the top):</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="13%" />
<col width="9%" />
<col width="13%" />
<col width="16%" />
<col width="16%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>client server</td>
<td>SSLv3</td>
<td>TLS</td>
<td>TLSv1</td>
<td>TLSv1.1</td>
<td>TLSv1.2</td>
</tr>
<tr class="row-even"><td>SSLv3</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>TLS (SSLv23)</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>TLSv1</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>TLSv1.1</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-even"><td>TLSv1.2</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>yes</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Note:</dt>
<dd>Which connections succeed will vary depending on the versions of the
ssl providers on both sides of the communication.</dd>
</dl>
<p>The ciphers parameter sets the available ciphers for this SSL object. It
should be a string in the wolfSSL cipher list format.</p>
<p>The parameter do_handshake_on_connect specifies whether to do the SSL
handshake automatically after doing a socket.connect(), or whether the
application program will call it explicitly, by invoking the
SSLSocket.do_handshake() method. Calling SSLSocket.do_handshake()
explicitly gives the program control over the blocking behavior of the
socket I/O involved in the handshake.</p>
<p>The parameter suppress_ragged_eofs is not supported yet.</p>
</dd></dl>

</div>
<div class="section" id="ssl-tls-context">
<h2>SSL/TLS Context<a class="headerlink" href="#ssl-tls-context" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="wolfssl.SSLContext">
<em class="property">class </em><code class="descclassname">wolfssl.</code><code class="descname">SSLContext</code><span class="sig-paren">(</span><em>protocol</em>, <em>server_side=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLContext" title="Permalink to this definition">¶</a></dt>
<dd><p>An SSLContext holds various SSL-related configuration options and
data, such as certificates and possibly a private key.</p>
<dl class="attribute">
<dt id="wolfssl.SSLContext.verify_mode">
<code class="descname">verify_mode</code><a class="headerlink" href="#wolfssl.SSLContext.verify_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to try to verify other peers’ certificates and how to behave
if verification fails. This attribute must be one of CERT_NONE,
CERT_OPTIONAL or CERT_REQUIRED.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLContext.wrap_socket">
<code class="descname">wrap_socket</code><span class="sig-paren">(</span><em>sock</em>, <em>server_side=False</em>, <em>do_handshake_on_connect=True</em>, <em>suppress_ragged_eofs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLContext.wrap_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap an existing Python socket sock and return an SSLSocket object.
sock must be a SOCK_STREAM socket; other socket types are unsupported.</p>
<p>The returned SSL socket is tied to the context, its settings and
certificates. The parameters server_side, do_handshake_on_connect and
suppress_ragged_eofs have the same meaning as in the top-level
wrap_socket() function.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLContext.set_ciphers">
<code class="descname">set_ciphers</code><span class="sig-paren">(</span><em>ciphers</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLContext.set_ciphers" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the available ciphers for sockets created with this context. It
should be a string in the wolfSSL cipher list format. If no cipher can
be selected (because compile-time options or other configuration
forbids use of all the specified ciphers), an SSLError will be raised.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLContext.load_cert_chain">
<code class="descname">load_cert_chain</code><span class="sig-paren">(</span><em>certfile</em>, <em>keyfile=None</em>, <em>password=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLContext.load_cert_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a private key and the corresponding certificate. The certfile
string must be the path to a single file in PEM format containing
the certificate as well as any number of CA certificates needed to
establish the certificate’s authenticity.</p>
<p>The keyfile string, if present, must point to a file containing the
private key in.</p>
<p>The password parameter is not supported yet.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLContext.load_verify_locations">
<code class="descname">load_verify_locations</code><span class="sig-paren">(</span><em>cafile=None</em>, <em>capath=None</em>, <em>cadata=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLContext.load_verify_locations" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a set of “certification authority” (CA) certificates used to
validate other peers’ certificates when verify_mode is other than
CERT_NONE. At least one of cafile or capath must be specified.</p>
<p>The cafile string, if present, is the path to a file of concatenated
CA certificates in PEM format.</p>
<p>The capath string, if present, is the path to a directory containing
several CA certificates in PEM format.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="ssl-tls-socket">
<h2>SSL/TLS Socket<a class="headerlink" href="#ssl-tls-socket" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="wolfssl.SSLSocket">
<em class="property">class </em><code class="descclassname">wolfssl.</code><code class="descname">SSLSocket</code><span class="sig-paren">(</span><em>sock=None</em>, <em>keyfile=None</em>, <em>certfile=None</em>, <em>server_side=False</em>, <em>cert_reqs=0</em>, <em>ssl_version=1</em>, <em>ca_certs=None</em>, <em>do_handshake_on_connect=True</em>, <em>family=&lt;AddressFamily.AF_INET: 2&gt;</em>, <em>sock_type=&lt;SocketKind.SOCK_STREAM: 1&gt;</em>, <em>proto=0</em>, <em>fileno=None</em>, <em>suppress_ragged_eofs=True</em>, <em>ciphers=None</em>, <em>_context=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLSocket" title="Permalink to this definition">¶</a></dt>
<dd><p>This class implements a subtype of socket.socket that wraps the
underlying OS socket in an SSL/TLS connection, providing secure
read and write methods over that channel.</p>
<dl class="attribute">
<dt id="wolfssl.SSLSocket.context">
<code class="descname">context</code><a class="headerlink" href="#wolfssl.SSLSocket.context" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the context used by this object.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLSocket.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLSocket.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write DATA to the underlying secure channel.
Returns number of bytes of DATA actually transmitted.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLSocket.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>length=1024</em>, <em>buffer=None</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLSocket.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read up to LENGTH bytes and return them.
Return zero-length string on EOF.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLSocket.unwrap">
<code class="descname">unwrap</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLSocket.unwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwraps the underlying OS socket from the SSL/TLS connection.
Returns the wrapped OS socket.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLSocket.do_handshake">
<code class="descname">do_handshake</code><span class="sig-paren">(</span><em>block=False</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLSocket.do_handshake" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a TLS/SSL handshake.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLSocket.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><em>addr</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLSocket.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to remote ADDR, and then wraps the connection in a secure
channel.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLSocket.connect_ex">
<code class="descname">connect_ex</code><span class="sig-paren">(</span><em>addr</em><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLSocket.connect_ex" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects to remote ADDR, and then wraps the connection in a secure
channel.</p>
</dd></dl>

<dl class="method">
<dt id="wolfssl.SSLSocket.accept">
<code class="descname">accept</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#wolfssl.SSLSocket.accept" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepts a new connection from a remote client, and returns a tuple
containing that new connection wrapped with a server-side secure
channel, and the address of the remote client.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<span id="document-examples"></span><div class="section" id="client-and-server-examples">
<h1>Client and Server Examples<a class="headerlink" href="#client-and-server-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ssl-tls-client-example">
<h2>SSL/TLS Client Example<a class="headerlink" href="#ssl-tls-client-example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">wolfssl</span>

<span class="n">CA_DATA</span> <span class="o">=</span> \
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">-----BEGIN CERTIFICATE-----</span>
<span class="sd">MIIDxTCCAq2gAwIBAgIQAqxcJmoLQJuPC3nyrkYldzANBgkqhkiG9w0BAQUFADBs</span>
<span class="sd">MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3</span>
<span class="sd">d3cuZGlnaWNlcnQuY29tMSswKQYDVQQDEyJEaWdpQ2VydCBIaWdoIEFzc3VyYW5j</span>
<span class="sd">ZSBFViBSb290IENBMB4XDTA2MTExMDAwMDAwMFoXDTMxMTExMDAwMDAwMFowbDEL</span>
<span class="sd">MAkGA1UEBhMCVVMxFTATBgNVBAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3</span>
<span class="sd">LmRpZ2ljZXJ0LmNvbTErMCkGA1UEAxMiRGlnaUNlcnQgSGlnaCBBc3N1cmFuY2Ug</span>
<span class="sd">RVYgUm9vdCBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMbM5XPm</span>
<span class="sd">+9S75S0tMqbf5YE/yc0lSbZxKsPVlDRnogocsF9ppkCxxLeyj9CYpKlBWTrT3JTW</span>
<span class="sd">PNt0OKRKzE0lgvdKpVMSOO7zSW1xkX5jtqumX8OkhPhPYlG++MXs2ziS4wblCJEM</span>
<span class="sd">xChBVfvLWokVfnHoNb9Ncgk9vjo4UFt3MRuNs8ckRZqnrG0AFFoEt7oT61EKmEFB</span>
<span class="sd">Ik5lYYeBQVCmeVyJ3hlKV9Uu5l0cUyx+mM0aBhakaHPQNAQTXKFx01p8VdteZOE3</span>
<span class="sd">hzBWBOURtCmAEvF5OYiiAhF8J2a3iLd48soKqDirCmTCv2ZdlYTBoSUeh10aUAsg</span>
<span class="sd">EsxBu24LUTi4S8sCAwEAAaNjMGEwDgYDVR0PAQH/BAQDAgGGMA8GA1UdEwEB/wQF</span>
<span class="sd">MAMBAf8wHQYDVR0OBBYEFLE+w2kD+L9HAdSYJhoIAu9jZCvDMB8GA1UdIwQYMBaA</span>
<span class="sd">FLE+w2kD+L9HAdSYJhoIAu9jZCvDMA0GCSqGSIb3DQEBBQUAA4IBAQAcGgaX3Nec</span>
<span class="sd">nzyIZgYIVyHbIUf4KmeqvxgydkAQV8GK83rZEWWONfqe/EW1ntlMMUu4kehDLI6z</span>
<span class="sd">eM7b41N5cdblIZQB2lWHmiRk9opmzN6cN82oNLFpmyPInngiK3BD41VHMWEZ71jF</span>
<span class="sd">hS9OMPagMRYjyOfiZRYzy78aG6A9+MpeizGLYAiJLQwGXFK3xPkKmNEVX58Svnw2</span>
<span class="sd">Yzi9RKR/5CYrCsSXaQ3pjOLAEFe4yHYSkVXySGnYvCoCWw9E1CAx2/S6cCZdkGCe</span>
<span class="sd">vEsXCS+0yx5DaMkHJ8HSXPfqIbloEpw8nL+e/IBcm2PN7EeqJSdnoDfzAIJ9VNep</span>
<span class="sd">+OkuE6N36B9K</span>
<span class="sd">-----END CERTIFICATE-----</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">bind_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">context</span> <span class="o">=</span> <span class="n">wolfssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">wolfssl</span><span class="o">.</span><span class="n">PROTOCOL_TLSv1_2</span><span class="p">)</span>

<span class="n">context</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="n">wolfssl</span><span class="o">.</span><span class="n">CERT_REQUIRED</span>
<span class="n">context</span><span class="o">.</span><span class="n">load_verify_locations</span><span class="p">(</span><span class="n">cadata</span><span class="o">=</span><span class="n">CA_DATA</span><span class="p">)</span>

<span class="n">secure_socket</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">bind_socket</span><span class="p">)</span>

<span class="n">secure_socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&quot;www.python.org&quot;</span><span class="p">,</span> <span class="mi">443</span><span class="p">))</span>

<span class="n">secure_socket</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;GET / HTTP/1.1</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">secure_socket</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="n">secure_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="ssl-tls-server-example">
<h2>SSL/TLS Server Example<a class="headerlink" href="#ssl-tls-server-example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">wolfssl</span>

<span class="n">bind_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">bind_socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">4433</span><span class="p">))</span>
<span class="n">bind_socket</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">context</span> <span class="o">=</span> <span class="n">wolfssl</span><span class="o">.</span><span class="n">SSLContext</span><span class="p">(</span><span class="n">wolfssl</span><span class="o">.</span><span class="n">PROTOCOL_TLSv1_2</span><span class="p">,</span> <span class="n">server_side</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">context</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span class="s2">&quot;certs/server-cert.pem&quot;</span><span class="p">,</span> <span class="s2">&quot;certs/server-key.pem&quot;</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">secure_socket</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">new_socket</span><span class="p">,</span> <span class="n">from_addr</span> <span class="o">=</span> <span class="n">bind_socket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

        <span class="n">secure_socket</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">new_socket</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Connection received from&quot;</span><span class="p">,</span> <span class="n">from_addr</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">secure_socket</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">secure_socket</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;I hear you fa shizzle!&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">print</span><span class="p">()</span>
        <span class="k">break</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">secure_socket</span><span class="p">:</span>
            <span class="n">secure_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">bind_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<span id="document-licensing"></span><div class="section" id="licensing">
<h1>Licensing<a class="headerlink" href="#licensing" title="Permalink to this headline">¶</a></h1>
<p>wolfSSL’s software is available under two distinct licensing models:
open source and standard commercial licensing. Please see the relevant
section below for information on each type of license.</p>
<div class="section" id="open-source">
<h2>Open Source<a class="headerlink" href="#open-source" title="Permalink to this headline">¶</a></h2>
<p>wolfCrypt and wolfSSL software are free software downloads and may be modified
to the needs of the user as long as the user adheres to version two of the GPL
License. The GPLv2 license can be found on the <a class="reference external" href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">gnu.org website</a>.</p>
</div>
<div class="section" id="commercial-licensing">
<h2>Commercial Licensing<a class="headerlink" href="#commercial-licensing" title="Permalink to this headline">¶</a></h2>
<p>Businesses and enterprises who wish to incorporate wolfSSL products into
proprietary appliances or other commercial software products for
re-distribution must license commercial versions. Licenses are generally issued
for one product and include unlimited royalty-free distribution. Custom
licensing terms are also available at <a class="reference external" href="mailto:licensing&#37;&#52;&#48;wolfssl&#46;com">licensing<span>&#64;</span>wolfssl<span>&#46;</span>com</a>.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, wolfSSL Inc. All rights reserved.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.13.0-0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>